<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Blast Off!</title>
    <link rel="stylesheet" 
	href="../styles/style.css">
	<script src="https://www.gstatic.com/firebasejs/4.12.1/firebase.js"></script>
	<script>
	// Initialize Firebase
	var config = {
    apiKey: "AIzaSyCHAGlFcD8WzHbEDeTmb6BOZ7XHGAEZB2E",
    authDomain: "grad-party-rsvp.firebaseapp.com",
    databaseURL: "https://grad-party-rsvp.firebaseio.com",
    projectId: "grad-party-rsvp",
    storageBucket: "",
    messagingSenderId: "1029606656078"
	};
	firebase.initializeApp(config);
	</script>
	
	<script>
	var Ref = firebase.database().ref();
	var rsvpRef = firebase.database().ref().child("Responses");
	rsvpRef.on("value",function(snapshot) {
		var headcount = 0;
		snapshot.forEach(function(childSnapshot) {
			var obj = childSnapshot.val();
			if(obj == "YES")
			{
				headcount++;
			}
		});
		Ref.child("Headcount").set(headcount);
	});
	
	function rsvpSubmit() {
		var name = document.getElementById("name").value;
		var form_elements = document.getElementById("rsvpForm").elements;
		var rsvpAnswer = form_elements['rsvp'].value;
		
		if (name == "" || rsvpAnswer == "")
		{
			window.alert("Not a valid response!");
		}
		else if (rsvpAnswer == "YES")
		{
			rsvpRef.child(name).set(rsvpAnswer);
			window.alert("Thank you "+name+", I can't wait to see you!");
		}
		
		else if (rsvpAnswer == "NO")
		{
			rsvpRef.child(name).set(rsvpAnswer);
			window.alert("I'm sorry you can't make it, "+name+"!");
		}
		rsvpForm.reset();	
	}
	
	function openWinHome() {
	   window.location.href = "../";
	}
	</script>
  </head>
  <body>
	<audio controls autoplay>
		<source src="../audio/mars.mp3" type="audio/mpeg">
	</audio>
	<div class="header">
		<h2 align="center">Blast Off!</h2>
		<ul>
			<li><input class= "buttonblast" target="home" type="button" value="Check out my personal webpage!" onclick="openWinHome()"></li>
		</ul>
	</div>
   <center>
   <div class="homespacer">
   </div>
	<div class="image">
      <img src="../images/starman.jpg" alt="starman" />
	  <div class="shadowblast">
	  </div>
	</div>
	
	<div>
	<form id="rsvpForm">
		<input id="name" class="nameText" type="text" placeholder="Enter your name..."></input>
		<br/>
		<br/>
		<label class="rsvpLabel"><b>Will you be in attendance?</b></label>
		<br/>
		<input id="radioY" class="rsvpRadio" type="radio" name="rsvp" value="YES"> 
		<label class="rsvpLabel"><b>YES</b></label>
		<input id="radioN" class="rsvpRadio" type="radio" name="rsvp" value="NO">
		<label class="rsvpLabel"><b>NO</b></label>
		<br/>
		<br/>
		<input class= "buttonblast" target="submit" type="button" value="Submit" onclick="rsvpSubmit()">
	</form>
	</div>
	
   </center>
   </body>
</html>